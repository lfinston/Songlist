%% /home/laurence/Songlist/all.tex
%% Created by Laurence D. Finston (LDF) Tue 25 May 2021 05:48:34 PM CEST

\input colordvi

\hlopts{bwidth=0}

\def\tocchapterentry#1#2#3{\line{#2. \medium #1 \dotfill\ #3}}
\def\tocsectionentry#1#2#3{\line{\hskip3em {#2}. \medium #1 \dotfill\ #3}}

\newcount\chapctr
\chapctr=0

\newcount\sectionctr
\sectionctr=0

%\the\sectionctr

\newcount\totalpages
\newcount\temppageno

\ifseparate
\def\Chapter#1#2{\relax}
\def\Section#1#2{\relax}
\openout\pagenoout=XXX.sh
\begingroup
\catcode`\%=12
\write\pagenoout{#! /bin/bash^^J}
\write\pagenoout{echo "Entering sep_all.sh"^^J}
\write\pagenoout{pdfseparate all_sep.pdf all_sep-%02d.pdf^^J}
\endgroup
\totalpages=1
\else
\def\Chapter#1#2{\advance\chapctr by 1\sectionctr=0%
\writenumberedtocentry{chapter}{\hlstart{}{bwidth=0}{#1}\Blue{#2}\hlend}{\the\chapctr}}
\def\Section#1#2{\advance\sectionctr by 1\edef\A{\the\chapctr .\the\sectionctr}%
\writenumberedtocentry{section}{\hlstart{}{bwidth=0}{#1}\Blue{#2}\hlend}{\A}}
\fi


%% This must be done in order to be able to pass filenames with underscores to \SEP as arguments.
%% LDF 2021.05.27.

\catcode`\_=12

\ifseparate
\else
\begingroup
\pageno=-1
\advance\baselineskip by .5\baselineskip
\centerline{{\largebx Table of Contents}}
\vskip.5\baselineskip
\readtocfile
\vfil\eject
\endgroup
\fi
\pageno=1

\advance\hoffset by .5cm
\advance\baselineskip by .5\baselineskip

\newlinechar=`^^J

\ifseparate
\prevpagecnt=1
\fi

\ifseparate
\def\SEP#1{\begingroup
\advance\totalpages by \pageno
\advance\totalpages by -2
\ifnum\prevpagecnt=\totalpages
\immediate\write\pagenoout{echo "Renaming all_sep-\ifnum\prevpagecnt<10 0\fi\the\prevpagecnt .pdf %
to #1"^^J}
\immediate\write\pagenoout{mv all_sep-\ifnum\prevpagecnt<10 0\fi\the\prevpagecnt .pdf %
#1^^J}
\else
\tempcnt=\prevpagecnt
\immediate\write\pagenoout{echo "Creating #1 with pdfunite"^^J}
\immediate\write\pagenoout{pdfunite |} 
\loop
\immediate\write\pagenoout{all_sep-\ifnum\tempcnt<10 0\fi\the\tempcnt .pdf |}
\advance\tempcnt by 1
\ifnum\tempcnt<\totalpages
\repeat
\immediate\write\pagenoout{all_sep-\ifnum\tempcnt<10 0\fi\the\tempcnt .pdf #1^^J}
\fi
\global\advance\totalpages by 1
\global\prevpagecnt=\totalpages
\endgroup}
\else
\def\SEP#1{\relax}
\fi

\Chapter{lead sheets}{Lead Sheets---All}

\input toc_ls.tex

\SEP{toc_ls.pdf}

\Section{lead sheets a-h}{A--H}

\input toc_ls_a_h.tex

\SEP{toc_ls_a_h.pdf}

\Section{lead sheets i-o}{I--O}

\input toc_ls_i_o.tex

\SEP{toc_ls_i_o.pdf}

\Section{lead sheets p-z}{P--Z}

\input toc_ls_p_z.tex

\SEP{toc_ls_p_z.pdf}

\Chapter{no page turns}{No Page Turns}

\input toc_npt.tex

\SEP{toc_npt.pdf}

\Chapter{composers}{Songs By Composer}

\input composers.tex

\SEP{composers.pdf}

\Chapter{lyricists}{Songs By Lyricist}

\input lyricists.tex

\SEP{lyricists.pdf}

\Chapter{scanned}{Scanned Lead Sheets}

\input scanned.tex

\SEP{scanned.pdf}

\Chapter{public domain}{Public Domain Songs}

\input pblcdomn.tex

\SEP{pblcdomn.pdf}

%% \immediate must be used here, otherwise an extra, unwanted page is produced.
%% For some reason, it has the wrong headline.  I don't know why.
%% LDF 2021.05.27.

\ifseparate
\immediate\write\pagenoout{rm -v -f `find . -regex "./all_sep-[0-9]+.*.pdf"`^^J}
\immediate\write\pagenoout{echo "Exiting sep_all.sh with exit status 0"}
\immediate\write\pagenoout{exit 0}
\immediate\closeout\pagenoout
\fi

\catcode`\_=8 %% Change catcode back to original value.

\endinput

%% (progn (plain-tex-mode) (auto-fill-mode 0))

%% Local Variables:
%% mode:plain-TeX
%% eval:(auto-fill-mode 0)
%% End:
